<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>互联网协议 | 唐悦玮</title>
    <meta name="description" content="努力只是一种生活方式，先敬业，再乐业">
    
    <meta name="keywords" content="唐悦玮,互联网协议,TCP/IP,HTTP2.0,HTTPS,OAuth 2.0,REST">
    <link rel="preload" href="/assets/css/0.styles.7719bba6.css" as="style"><link rel="preload" href="/assets/js/app.dafca27f.js" as="script"><link rel="preload" href="/assets/js/16.e9d8785e.js" as="script"><link rel="prefetch" href="/assets/js/10.89944a89.js"><link rel="prefetch" href="/assets/js/11.8f57ad31.js"><link rel="prefetch" href="/assets/js/12.c3d9c1bd.js"><link rel="prefetch" href="/assets/js/13.2c5f587a.js"><link rel="prefetch" href="/assets/js/14.3f6f4540.js"><link rel="prefetch" href="/assets/js/15.64ee9c0d.js"><link rel="prefetch" href="/assets/js/17.755e71c5.js"><link rel="prefetch" href="/assets/js/18.4692b75b.js"><link rel="prefetch" href="/assets/js/19.46570128.js"><link rel="prefetch" href="/assets/js/2.571deff1.js"><link rel="prefetch" href="/assets/js/20.0f7d1aad.js"><link rel="prefetch" href="/assets/js/21.27958e43.js"><link rel="prefetch" href="/assets/js/22.eabe7685.js"><link rel="prefetch" href="/assets/js/23.78078e76.js"><link rel="prefetch" href="/assets/js/24.96c3688d.js"><link rel="prefetch" href="/assets/js/25.b065d8ab.js"><link rel="prefetch" href="/assets/js/26.8ba0a8ca.js"><link rel="prefetch" href="/assets/js/27.f0b9e5a4.js"><link rel="prefetch" href="/assets/js/28.f43706de.js"><link rel="prefetch" href="/assets/js/29.a3154769.js"><link rel="prefetch" href="/assets/js/3.c2e4dfa6.js"><link rel="prefetch" href="/assets/js/30.4cfb2027.js"><link rel="prefetch" href="/assets/js/31.43203da2.js"><link rel="prefetch" href="/assets/js/32.61565cec.js"><link rel="prefetch" href="/assets/js/33.fc420ec9.js"><link rel="prefetch" href="/assets/js/34.2a7eca2e.js"><link rel="prefetch" href="/assets/js/35.58b3328a.js"><link rel="prefetch" href="/assets/js/36.ec563d89.js"><link rel="prefetch" href="/assets/js/37.d28df710.js"><link rel="prefetch" href="/assets/js/38.9160b0d9.js"><link rel="prefetch" href="/assets/js/39.30b220cc.js"><link rel="prefetch" href="/assets/js/4.3979c956.js"><link rel="prefetch" href="/assets/js/40.f73a6570.js"><link rel="prefetch" href="/assets/js/41.c62978be.js"><link rel="prefetch" href="/assets/js/42.bcdd7e37.js"><link rel="prefetch" href="/assets/js/43.2570e949.js"><link rel="prefetch" href="/assets/js/44.0761b973.js"><link rel="prefetch" href="/assets/js/45.41eb53f9.js"><link rel="prefetch" href="/assets/js/46.20085973.js"><link rel="prefetch" href="/assets/js/47.10beda24.js"><link rel="prefetch" href="/assets/js/48.06037651.js"><link rel="prefetch" href="/assets/js/49.541ba003.js"><link rel="prefetch" href="/assets/js/5.6cd04aeb.js"><link rel="prefetch" href="/assets/js/50.177c7290.js"><link rel="prefetch" href="/assets/js/51.811b524c.js"><link rel="prefetch" href="/assets/js/52.f856a126.js"><link rel="prefetch" href="/assets/js/53.0f63340b.js"><link rel="prefetch" href="/assets/js/54.780978e0.js"><link rel="prefetch" href="/assets/js/55.93847180.js"><link rel="prefetch" href="/assets/js/56.488f616b.js"><link rel="prefetch" href="/assets/js/57.2d3a61fc.js"><link rel="prefetch" href="/assets/js/58.f83bc7ad.js"><link rel="prefetch" href="/assets/js/59.360b675c.js"><link rel="prefetch" href="/assets/js/6.ce0124ec.js"><link rel="prefetch" href="/assets/js/60.d42202fa.js"><link rel="prefetch" href="/assets/js/61.bef3ca04.js"><link rel="prefetch" href="/assets/js/62.e7acbdda.js"><link rel="prefetch" href="/assets/js/63.48d106d5.js"><link rel="prefetch" href="/assets/js/64.b1f0cfc6.js"><link rel="prefetch" href="/assets/js/65.0463a886.js"><link rel="prefetch" href="/assets/js/66.4849b436.js"><link rel="prefetch" href="/assets/js/67.ffb76c3b.js"><link rel="prefetch" href="/assets/js/68.6bc710bf.js"><link rel="prefetch" href="/assets/js/69.0fab5464.js"><link rel="prefetch" href="/assets/js/7.11460e2e.js"><link rel="prefetch" href="/assets/js/70.68143566.js"><link rel="prefetch" href="/assets/js/71.8257ea89.js"><link rel="prefetch" href="/assets/js/72.3656725d.js"><link rel="prefetch" href="/assets/js/73.6c145edc.js"><link rel="prefetch" href="/assets/js/74.c7acc8b5.js"><link rel="prefetch" href="/assets/js/75.320d938f.js"><link rel="prefetch" href="/assets/js/76.e19a7885.js"><link rel="prefetch" href="/assets/js/77.2638740b.js"><link rel="prefetch" href="/assets/js/78.566788a7.js"><link rel="prefetch" href="/assets/js/79.39102df2.js"><link rel="prefetch" href="/assets/js/8.5f58e5c3.js"><link rel="prefetch" href="/assets/js/80.d4d52e22.js"><link rel="prefetch" href="/assets/js/81.f891e8df.js"><link rel="prefetch" href="/assets/js/82.3466fcc9.js"><link rel="prefetch" href="/assets/js/83.2fefaab9.js"><link rel="prefetch" href="/assets/js/84.fac67119.js"><link rel="prefetch" href="/assets/js/85.ebb8074c.js"><link rel="prefetch" href="/assets/js/86.4004b044.js"><link rel="prefetch" href="/assets/js/87.0d24d9af.js"><link rel="prefetch" href="/assets/js/88.90fe23ea.js"><link rel="prefetch" href="/assets/js/9.f7a98062.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7719bba6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">唐悦玮</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/technical/" class="nav-link">技术博客</a></div><div class="nav-item"><a href="/article/" class="nav-link">管理思维</a></div><div class="nav-item"><a href="/micro_service/" class="nav-link">微服务架构</a></div><div class="nav-item"><a href="http://blog.tangyuewei.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客系统
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/technical/" class="nav-link">技术博客</a></div><div class="nav-item"><a href="/article/" class="nav-link">管理思维</a></div><div class="nav-item"><a href="/micro_service/" class="nav-link">微服务架构</a></div><div class="nav-item"><a href="http://blog.tangyuewei.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客系统
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>计算机基础</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/computer_foundation/计算机基础.html" class="sidebar-link">计算机基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer_foundation/计算机基础.html#计算机本质" class="sidebar-link">计算机本质</a></li></ul></li><li><a href="/computer_foundation/操作系统.html" class="sidebar-link">操作系统</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer_foundation/操作系统.html#分类" class="sidebar-link">分类</a></li></ul></li><li><a href="/computer_foundation/计算机网络.html" class="sidebar-link">计算机网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer_foundation/计算机网络.html#主要网络" class="sidebar-link">主要网络</a></li></ul></li><li><a href="/computer_foundation/互联网协议.html" class="active sidebar-link">互联网协议</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer_foundation/互联网协议.html#tcp-ip" class="sidebar-link">TCP/IP</a></li><li class="sidebar-sub-header"><a href="/computer_foundation/互联网协议.html#http2-0" class="sidebar-link">HTTP2.0</a></li><li class="sidebar-sub-header"><a href="/computer_foundation/互联网协议.html#https" class="sidebar-link">HTTPS</a></li><li class="sidebar-sub-header"><a href="/computer_foundation/互联网协议.html#oauth-2-0" class="sidebar-link">OAuth 2.0</a></li><li class="sidebar-sub-header"><a href="/computer_foundation/互联网协议.html#rest" class="sidebar-link">REST</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Java编程</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>软件工程</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>数据</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>算法与数据结构</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>分布式系统</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="互联网协议"><a href="#互联网协议" aria-hidden="true" class="header-anchor">#</a> 互联网协议</h1> <h2 id="tcp-ip"><a href="#tcp-ip" aria-hidden="true" class="header-anchor">#</a> TCP/IP</h2> <h3 id="模型"><a href="#模型" aria-hidden="true" class="header-anchor">#</a> 模型</h3> <p><img src="/tcp20190507152344.png" alt="tcp模型" title="tcp模型"></p> <h3 id="建立连接"><a href="#建立连接" aria-hidden="true" class="header-anchor">#</a> 建立连接</h3> <p>客户端与服务器建立一个 TCP 连接时需要总共发送三个包以确认连接的建立。
<img src="/tcplj20190507154041.png" alt="建立连接" title="三次握手建立连接"></p> <ol><li>客户端将标志位SYN置为1，随机产生一个值seq=J，并将该数据包发送给服务器端，客户端进入SYN_SENT状态，等待服务器端确认。</li> <li>服务器端收到数据包后由标志位SYN=1知道客户端请求建立连接，服务器端将标志位SYN和ACK都置为1，ack=J+1，随机产生一个值seq=K，并将该数据包发送给客户端以确认连接请求，服务器端进入SYN_RCVD状态。</li> <li>客户端收到确认后，检查ack是否为J+1，ACK是否为1，如果正确则将标志位ACK置为1，ack=K+1，并将该数据包发送给服务器端，服务器端检查ack是否为K+1，ACK是否为1，如果正确则连接建立成功，客户端和服务器端进入ESTABLISHED状态，然后客户端与服务器端之间就可以开始传输数据了。</li></ol> <h3 id="断开连接"><a href="#断开连接" aria-hidden="true" class="header-anchor">#</a> 断开连接</h3> <p>客户端与服务器断开连接时需要总共发送四个包以确认连接的断开。
<img src="/tcpdk20190507154540.png" alt="断开连接" title="四次握手断开连接"></p> <ol><li>客户端发送一个FIN=M，用来关闭客户端到服务器端的数据传送，客户端进入FIN_WAIT_1状态。此时可以继续发送数据。</li> <li>服务器端收到FIN后，向客户端发送ack=M+1。客户端进入FIN_WAIT_2 状态，继续等待服务器端的FIN报文。</li> <li>服务器端确定数据已发送完成，则向客户端发送FIN=N报文。服务器准备关闭连接了，服务器端进入LAST_ACK状态。</li> <li>客户端收到FIN=N报文后，发送ack=N+1后进入TIME_WAIT状态，如果Server端没有收到ACK则可以重传。服务器端收到ACK后，就知道可以断开连接了。（客户端等待了2MSL后依然没有收到回复，说明服务器端已关闭，客户端也可以关闭连接了）</li></ol> <h2 id="http2-0"><a href="#http2-0" aria-hidden="true" class="header-anchor">#</a> HTTP2.0</h2> <h3 id="http概述"><a href="#http概述" aria-hidden="true" class="header-anchor">#</a> HTTP概述</h3> <ul><li>HTTP历史：HTTP 建立之初，主要是为了将超文本标记语言(HTML)文档从Web服务器传送到客户端的浏览器。</li> <li>HTTP的优化：带宽和延迟。
<ul><li>带宽：拨号上网的阶段，带宽可能会成为一个比较严重影响请求的问题，现在网络基础建设已经使得带宽得到极大的提升，不用再担心带宽影响网速了。</li> <li>延迟：
<ul><li>浏览器阻塞（HOL blocking）：浏览器会因为某些原因阻塞请求。浏览器对于同一个域名，同时只能有 4 个连接（根据浏览器内核不同可能会有所差异），超过浏览器最大连接数限制，后续请求就会被阻塞。</li> <li>DNS 查询（DNS Lookup）：浏览器需要知道目标服务器的 IP 才能建立连接。将域名解析为 IP 的这个系统就是 DNS。通常可以利用DNS缓存结果来减少这个时间。</li> <li>建立连接（Initial connection）：HTTP 是基于 TCP 协议的，浏览器最快也要在第三次握手时才能建立连接，连接无法复用会导致每次请求都经历三次握手和慢启动。三次握手在高延迟的场景下影响较明显，慢启动则对文件类的大请求影响较大。</li></ul></li></ul></li></ul> <blockquote><p>互联网专家们将新一代加密协议称为“HTTP 2.0”。</p></blockquote> <h3 id="http2-0特点"><a href="#http2-0特点" aria-hidden="true" class="header-anchor">#</a> HTTP2.0特点</h3> <ol><li>二进制传输
http2.0采用二进制传输，相较于文本传输的http1.0来说更加安全可靠。</li> <li>多路复用
http1.0一个连接只能提交一个请求，而http2.0可以同时处理多个请求，可以降低连接的占用数量，提升网络的速度。</li> <li>头部压缩
http2.0使用HPACK算法对头部进行压缩，既避免了重复header的传输，又减小了需要传输数据的大小。</li> <li>服务端推送
服务端可以主动推送资源给客户端，避免客户端花过多的时间逐个请求资源，降低整个请求的响应时间。</li></ol> <h2 id="https"><a href="#https" aria-hidden="true" class="header-anchor">#</a> HTTPS</h2> <h3 id="https概述"><a href="#https概述" aria-hidden="true" class="header-anchor">#</a> HTTPS概述</h3> <p>HTTPS是HTTP的安全版，HTTPS的安全基础是SSL，HTTPS是让HTTP先和SSL（Secure Sockets Layer）通信，再由SSL和TCP通信。即HTTPS使用了隧道进行通信。
HTTPS = HTTP+SSL/TLS。</p> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>通过使用 SSL，HTTPs 具有了加密（防窃听）、认证（防伪装）和完整性保护（防篡改）</p></div> <blockquote><p>由于HTTP报文的不安全性，网景在1994年就创建了HTTPS，并用在浏览器中。最初HTTPS是和SSL一起使用，然后演化为TLS。SSL／TLS在OSI模型中都是表示层的协议。SSL使 用40 位关键字作为RC4流加密算法，这对于商业信息的加密是合适的。</p></blockquote> <h3 id="http升级https"><a href="#http升级https" aria-hidden="true" class="header-anchor">#</a> HTTP升级HTTPS</h3> <ol><li>CA证书，大部分证书都是需要收费的，当然，自己在服务器上用openssl也可以，不过浏览器会提示当前私密连接不安全这个警告，普通人看到这种信息是不会继续浏览的，所以，想使用HTTPS，可以使用Let's Encrypt，由谷歌等公司推行。</li> <li>HTTPS性能优化，SSL握手，HTTPS 对速度会有一定程度的降低，但是只要经过合理优化和部署，HTTPS 对速度的影响完全可以接受。</li> <li>CPU计算压力，HTTPS中大量的秘钥算法计算，对CPU会有一定的压力。</li> <li>http和https使用的是完全不同的连接方式，http端口是80，https端口是443。</li></ol> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>HTTPS下的网站，所有子链都要使用HTTPS。</p></div> <h2 id="oauth-2-0"><a href="#oauth-2-0" aria-hidden="true" class="header-anchor">#</a> OAuth 2.0</h2> <h3 id="概述"><a href="#概述" aria-hidden="true" class="header-anchor">#</a> 概述</h3> <blockquote><p>OAuth 2.0是行业标准的授权协议。OAuth 2.0取代了2006年创建的原始OAuth协议所做的工作.OAuth 2.0专注于客户端开发人员的简单性，同时为Web应用程序，桌面应用程序，移动电话和客厅设备提供特定的授权流程。该规范及其扩展正在IETF OAuth工作组内开发。</p></blockquote> <p>OAuth 就是一种授权机制。数据的所有者告诉系统，同意授权第三方应用进入系统，获取这些数据。系统从而产生一个短期的进入令牌（token），用来代替密码，供第三方应用使用。</p> <h3 id="授权方式"><a href="#授权方式" aria-hidden="true" class="header-anchor">#</a> 授权方式</h3> <ul><li>授权码（authorization-code）
<ul><li>申请一个授权码</li> <li>用授权码获取令牌</li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>安全性高</p></div> <ul><li>隐藏式（implicit）
<ul><li>直接向前端颁发令牌</li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>安全性低（只能用于安全要求不高的场景，并且令牌的有效期必须非常短，通常就是会话期间（session）有效，浏览器关掉，令牌就失效了。）</p></div> <ul><li>密码式（password）
<ul><li>用户名和密码，直接告诉该应用</li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>用户高度信任的应用（暴露了用户名和密码）</p></div> <ul><li>客户端凭证（client credentials）
<ul><li>在命令行下请求令牌</li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>一般针对第三方应用，而不是针对用户的，即有可能多个用户共享同一个令牌。</p></div> <h3 id="更新令牌"><a href="#更新令牌" aria-hidden="true" class="header-anchor">#</a> 更新令牌</h3> <p>令牌到期前，用户使用 refresh token 发一个请求，去更新令牌。</p> <h2 id="rest"><a href="#rest" aria-hidden="true" class="header-anchor">#</a> REST</h2> <h3 id="概述-2"><a href="#概述-2" aria-hidden="true" class="header-anchor">#</a> 概述</h3> <p>一种软件架构风格，REST的架构风格是针对Web应用设计和开发的，它使得HTTP协议的原本面貌得以被了解。使用REST可以降低开发的复杂性，提高系统的可伸缩性。如今，REST架构已经成为主流技术。</p> <h3 id="rest的设计标准"><a href="#rest的设计标准" aria-hidden="true" class="header-anchor">#</a> REST的设计标准</h3> <ol><li>网络上的所有事物都被抽象为资源（resource）。</li> <li>每个资源对应一个唯一的资源标识符（resource identifier）。</li> <li>通过通用的连接器接口（generic connector interface）对资源进行操作。</li> <li>对资源的各种操作不会改变资源标识符。</li> <li>所有的操作都是无状态的（stateless）。</li></ol></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2020-3-12 15:44:09</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/computer_foundation/计算机网络.html" class="prev">
          计算机网络
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.dafca27f.js" defer></script><script src="/assets/js/16.e9d8785e.js" defer></script>
  </body>
</html>
